<div class="loading" 
     [attr.data-type]="type()" 
     [attr.data-size]="size()"
     [libStyleFallback]="fallbackStyles()"
     [fallbackClasses]="fallbackClasses()"
     [criticalStyles]="true">
  
  @switch (type()) {
    @case ('spinner') {
      <div class="loading__spinner" 
           libStyleFallback="position: relative">
        <div class="loading__spinner-circle"
             [libStyleFallback]="getSpinnerFallbackStyles()"
             [criticalStyles]="true"></div>
      </div>
    }
    
    @case ('skeleton') {
      <div class="loading__skeleton"
           libStyleFallback="display: flex; align-items: flex-start; gap: 0.75rem; width: 100%; max-width: 24rem">
        @if (showAvatar()) {
          <div class="loading__skeleton-avatar"
               libStyleFallback="width: 2.5rem; height: 2.5rem; background-color: var(--loading-secondary-color, #e5e7eb); border-radius: 50%; animation: lib-pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite"></div>
        }
        <div class="loading__skeleton-content"
             libStyleFallback="flex: 1; display: flex; flex-direction: column; gap: 0.5rem">
          @for (line of getLines(); track $index) {
            <div class="loading__skeleton-line" 
                 [style.width.%]="$index === lines() - 1 ? 60 : 100"
                 libStyleFallback="height: 1rem; background-color: var(--loading-secondary-color, #e5e7eb); border-radius: 0.25rem; animation: lib-pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite"></div>
          }
        </div>
      </div>
    }
    
    @case ('dots') {
      <div class="loading__dots"
           libStyleFallback="display: flex; gap: 0.25rem">
        <div class="loading__dot"
             [libStyleFallback]="getDotsFallbackStyles()"
             [criticalStyles]="true"
             style="animation-delay: 0ms"></div>
        <div class="loading__dot"
             [libStyleFallback]="getDotsFallbackStyles()"
             [criticalStyles]="true"
             style="animation-delay: 150ms"></div>
        <div class="loading__dot"
             [libStyleFallback]="getDotsFallbackStyles()"
             [criticalStyles]="true"
             style="animation-delay: 300ms"></div>
      </div>
    }
    
    @case ('pulse') {
      <div class="loading__pulse"
           [libStyleFallback]="getPulseFallbackStyles()"
           [criticalStyles]="true"></div>
    }
  }
  
  @if (message()) {
    <p class="loading__message"
       libStyleFallback="margin-top: 0.5rem; font-size: 0.875rem; line-height: 1.25rem; color: var(--loading-text-color, #4b5563)">{{ message() }}</p>
  }
</div>